<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A thread-safe object pool collection with automatic return."><title>lockfree_object_pool - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-c5d6553a23f1e5a6.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="lockfree_object_pool" data-themes="" data-resource-suffix="" data-rustdoc-version="1.81.0 (eeb90cda1 2024-09-04)" data-channel="1.81.0" data-search-js="search-d234aafac6c221dd.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-d2fab2bf619172d3.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../lockfree_object_pool/index.html">lockfree_object_pool</a><span class="version">0.1.6</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">lockfree_object_pool</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/lockfree_object_pool/lib.rs.html#1-108">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A thread-safe object pool collection with automatic return.</p>
<p>Some implementations are lockfree :</p>
<ul>
<li><a href="struct.LinearObjectPool.html" title="struct lockfree_object_pool::LinearObjectPool"><code>LinearObjectPool</code></a></li>
<li><a href="struct.SpinLockObjectPool.html" title="struct lockfree_object_pool::SpinLockObjectPool"><code>SpinLockObjectPool</code></a></li>
</ul>
<p>Other use std::Mutex :</p>
<ul>
<li><a href="struct.MutexObjectPool.html" title="struct lockfree_object_pool::MutexObjectPool"><code>MutexObjectPool</code></a></li>
</ul>
<p>And <a href="struct.NoneObjectPool.html" title="struct lockfree_object_pool::NoneObjectPool"><code>NoneObjectPool</code></a> basic allocation without pool.</p>
<h3 id="example"><a class="doc-anchor" href="#example">§</a>Example</h3>
<p>The general pool creation looks like this for</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code>  <span class="kw">use </span>lockfree_object_pool::LinearObjectPool;
   
  <span class="kw">let </span>pool = LinearObjectPool::&lt;u32&gt;::new(
    ||  Default::default(),
    |v| {<span class="kw-2">*</span>v = <span class="number">0</span>; });

  <span class="comment">// And use the object pool
  </span><span class="kw">let </span><span class="kw-2">mut </span>item = pool.pull();
  <span class="kw-2">*</span>item = <span class="number">5</span>;</code></pre></div>
<p>At the end of the scope item return in object pool.</p>
<h3 id="multithreading"><a class="doc-anchor" href="#multithreading">§</a>Multithreading</h3>
<p>All implementation support allocation/desallocation from on or more thread. You only need to wrap the pool in a <a href="https://doc.rust-lang.org/1.81.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc"><code>std::sync::Arc</code></a> :</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code>  <span class="kw">use </span>lockfree_object_pool::LinearObjectPool;
  <span class="kw">use </span>std::sync::Arc;

  <span class="kw">let </span>pool = Arc::new(LinearObjectPool::&lt;u32&gt;::new(
       ||  Default::default(),
       |v| {<span class="kw-2">*</span>v = <span class="number">0</span>; }));</code></pre></div>
<h3 id="performance"><a class="doc-anchor" href="#performance">§</a>Performance</h3>
<p>Global <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion/report/index.html">report</a>.</p>
<h5 id="allocation"><a class="doc-anchor" href="#allocation">§</a>Allocation</h5><div><table><thead><tr><th>ObjectPool</th><th style="text-align: center">Duration in Monothreading (us)</th><th style="text-align: center">Duration Multithreading (us)</th></tr></thead><tbody>
<tr><td><a href="struct.NoneObjectPool.html" title="struct lockfree_object_pool::NoneObjectPool"><code>NoneObjectPool</code></a></td><td style="text-align: center">1.2848</td><td style="text-align: center">0.62509</td></tr>
<tr><td><a href="struct.MutexObjectPool.html" title="struct lockfree_object_pool::MutexObjectPool"><code>MutexObjectPool</code></a></td><td style="text-align: center">1.3107</td><td style="text-align: center">1.5178</td></tr>
<tr><td><a href="struct.SpinLockObjectPool.html" title="struct lockfree_object_pool::SpinLockObjectPool"><code>SpinLockObjectPool</code></a></td><td style="text-align: center">1.3106</td><td style="text-align: center">1.3684</td></tr>
<tr><td><a href="struct.LinearObjectPool.html" title="struct lockfree_object_pool::LinearObjectPool"><code>LinearObjectPool</code></a></td><td style="text-align: center">0.23732</td><td style="text-align: center">0.38913</td></tr>
<tr><td>[<code>crate 'sharded-slab'</code>]</td><td style="text-align: center">1.6264</td><td style="text-align: center">0.82607</td></tr>
<tr><td>[<code>crate 'object-pool'</code>]</td><td style="text-align: center">0.77533</td><td style="text-align: center">0.26224</td></tr>
</tbody></table>
</div>
<p>Report <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion/allocation/report/index.html">monothreading</a> and <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion/multi%20thread%20allocation/report/index.html">multithreading</a></p>
<h5 id="forward-message-between-thread"><a class="doc-anchor" href="#forward-message-between-thread">§</a>Forward Message between Thread</h5><div><table><thead><tr><th>ObjectPool</th><th style="text-align: center">1 Reader - 1 Writter (ns)</th><th style="text-align: center">5 Reader - 1 Writter (ns)</th><th style="text-align: center">1 Reader - 5 Writter (ns)</th><th style="text-align: center">5 Reader - 5 Writter (ns)</th></tr></thead><tbody>
<tr><td><a href="struct.NoneObjectPool.html" title="struct lockfree_object_pool::NoneObjectPool"><code>NoneObjectPool</code></a></td><td style="text-align: center">529.75</td><td style="text-align: center">290.47</td><td style="text-align: center">926.05</td><td style="text-align: center">722.35</td></tr>
<tr><td><a href="struct.MutexObjectPool.html" title="struct lockfree_object_pool::MutexObjectPool"><code>MutexObjectPool</code></a></td><td style="text-align: center">429.29</td><td style="text-align: center">207.17</td><td style="text-align: center">909.88</td><td style="text-align: center">409.99</td></tr>
<tr><td><a href="struct.SpinLockObjectPool.html" title="struct lockfree_object_pool::SpinLockObjectPool"><code>SpinLockObjectPool</code></a></td><td style="text-align: center">34.277</td><td style="text-align: center">182.62</td><td style="text-align: center">1089.7</td><td style="text-align: center">483.81</td></tr>
<tr><td><a href="struct.LinearObjectPool.html" title="struct lockfree_object_pool::LinearObjectPool"><code>LinearObjectPool</code></a></td><td style="text-align: center">43.876</td><td style="text-align: center">163.18</td><td style="text-align: center">365.56</td><td style="text-align: center">326.92</td></tr>
<tr><td>[<code>crate 'sharded-slab'</code>]</td><td style="text-align: center">525.82</td><td style="text-align: center">775.79</td><td style="text-align: center">966.87</td><td style="text-align: center">1289.2</td></tr>
</tbody></table>
</div>
<p>Not supported by [<code>crate 'object-pool'</code>]</p>
<p>Report <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion//forward%20msg%20from%20pull%20(nb_writter_1%20nb_readder_1)/report/index.html">1-1</a>, <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion//forward%20msg%20from%20pull%20(nb_writter_1%20nb_readder_5)/report/index.html">5-1</a>, <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion//forward%20msg%20from%20pull%20(nb_writter_5%20nb_readder_1)/report/index.html">1-5</a> , <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion//forward%20msg%20from%20pull%20(nb_writter_5%20nb_readder_5)/report/index.html">5-5</a></p>
<h5 id="desallocation"><a class="doc-anchor" href="#desallocation">§</a>Desallocation</h5><div><table><thead><tr><th>ObjectPool</th><th style="text-align: center">Duration in Monothreading (ns)</th><th style="text-align: center">Duration Multithreading (ns)</th></tr></thead><tbody>
<tr><td><a href="struct.NoneObjectPool.html" title="struct lockfree_object_pool::NoneObjectPool"><code>NoneObjectPool</code></a></td><td style="text-align: center">111.81</td><td style="text-align: center">93.585</td></tr>
<tr><td><a href="struct.MutexObjectPool.html" title="struct lockfree_object_pool::MutexObjectPool"><code>MutexObjectPool</code></a></td><td style="text-align: center">26.108</td><td style="text-align: center">101.86</td></tr>
<tr><td><a href="struct.SpinLockObjectPool.html" title="struct lockfree_object_pool::SpinLockObjectPool"><code>SpinLockObjectPool</code></a></td><td style="text-align: center">22.441</td><td style="text-align: center">50.107</td></tr>
<tr><td><a href="struct.LinearObjectPool.html" title="struct lockfree_object_pool::LinearObjectPool"><code>LinearObjectPool</code></a></td><td style="text-align: center">7.5379</td><td style="text-align: center">41.707</td></tr>
<tr><td>[<code>crate 'sharded-slab'</code>]</td><td style="text-align: center">7.0394</td><td style="text-align: center">10.283</td></tr>
<tr><td>[<code>crate 'object-pool'</code>]</td><td style="text-align: center">20.517</td><td style="text-align: center">44.798</td></tr>
</tbody></table>
</div>
<p>Report <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion/free/report/index.html">monothreading</a> and <a href="https://evaillant.github.io/lockfree-object-pool/benches/criterion/multi%20thread%20free/report/index.html">multithreading</a></p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.LinearObjectPool.html" title="struct lockfree_object_pool::LinearObjectPool">LinearObjectPool</a></div><div class="desc docblock-short">ObjectPool use a lockfree vector to secure multithread access to pull.</div></li><li><div class="item-name"><a class="struct" href="struct.LinearOwnedReusable.html" title="struct lockfree_object_pool::LinearOwnedReusable">LinearOwnedReusable</a></div><div class="desc docblock-short">Wrapper over T used by <a href="struct.LinearObjectPool.html" title="struct lockfree_object_pool::LinearObjectPool"><code>LinearObjectPool</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.LinearReusable.html" title="struct lockfree_object_pool::LinearReusable">LinearReusable</a></div><div class="desc docblock-short">Wrapper over T used by <a href="struct.LinearObjectPool.html" title="struct lockfree_object_pool::LinearObjectPool"><code>LinearObjectPool</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.MutexObjectPool.html" title="struct lockfree_object_pool::MutexObjectPool">MutexObjectPool</a></div><div class="desc docblock-short">ObjectPool use a <a href="https://doc.rust-lang.org/1.81.0/std/sync/mutex/struct.Mutex.html" title="struct std::sync::mutex::Mutex"><code>std::sync::Mutex</code></a> over vector to secure multithread access to pull.</div></li><li><div class="item-name"><a class="struct" href="struct.MutexOwnedReusable.html" title="struct lockfree_object_pool::MutexOwnedReusable">MutexOwnedReusable</a></div><div class="desc docblock-short">Wrapper over T used by <a href="struct.MutexObjectPool.html" title="struct lockfree_object_pool::MutexObjectPool"><code>MutexObjectPool</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.MutexReusable.html" title="struct lockfree_object_pool::MutexReusable">MutexReusable</a></div><div class="desc docblock-short">Wrapper over T used by <a href="struct.MutexObjectPool.html" title="struct lockfree_object_pool::MutexObjectPool"><code>MutexObjectPool</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.NoneObjectPool.html" title="struct lockfree_object_pool::NoneObjectPool">NoneObjectPool</a></div><div class="desc docblock-short">Basic allocation without pull. Used to compare default rust allocation with different kind of object pool.</div></li><li><div class="item-name"><a class="struct" href="struct.NoneReusable.html" title="struct lockfree_object_pool::NoneReusable">NoneReusable</a></div><div class="desc docblock-short">Wrapper over T used by <a href="struct.NoneObjectPool.html" title="struct lockfree_object_pool::NoneObjectPool"><code>NoneObjectPool</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.SpinLockObjectPool.html" title="struct lockfree_object_pool::SpinLockObjectPool">SpinLockObjectPool</a></div><div class="desc docblock-short">ObjectPool use a spin lock over vector to secure multithread access to pull.</div></li><li><div class="item-name"><a class="struct" href="struct.SpinLockOwnedReusable.html" title="struct lockfree_object_pool::SpinLockOwnedReusable">SpinLockOwnedReusable</a></div><div class="desc docblock-short">Wrapper over T used by <a href="struct.SpinLockObjectPool.html" title="struct lockfree_object_pool::SpinLockObjectPool"><code>SpinLockObjectPool</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.SpinLockReusable.html" title="struct lockfree_object_pool::SpinLockReusable">SpinLockReusable</a></div><div class="desc docblock-short">Wrapper over T used by <a href="struct.SpinLockObjectPool.html" title="struct lockfree_object_pool::SpinLockObjectPool"><code>SpinLockObjectPool</code></a>.</div></li></ul></section></div></main></body></html>