<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This crate implements diffing utilities.  It attempts to provide an abstraction interface over different types of diffing algorithms.  The design of the library is inspired by pijul’s diff library by Pierre-Étienne Meunier and also inherits the patience diff algorithm from there."><meta name="keywords" content="rust, rustlang, rust-lang, similar"><title>similar - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a class="sidebar-logo" href="../similar/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.png" alt="logo"></div>
        </a><h2 class="location">Crate similar</h2><div class="block version"><div class="narrow-helper"></div><p>Version 2.1.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all similar's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div><div id="sidebar-vars" data-name="similar" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../similar/index.html"><img class="rust-logo" src="../rust-logo.png" alt="logo"></a><nav class="sub"><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">similar</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/similar/lib.rs.html#1-163" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This crate implements diffing utilities.  It attempts to provide an abstraction
interface over different types of diffing algorithms.  The design of the
library is inspired by pijul’s diff library by Pierre-Étienne Meunier and
also inherits the patience diff algorithm from there.</p>
<p>The API of the crate is split into high and low level functionality.  Most
of what you probably want to use is available top level.  Additionally the
following sub modules exist:</p>
<ul>
<li><a href="algorithms/index.html" title="algorithms"><code>algorithms</code></a>: This implements the different types of diffing algorithms.
It provides both low level access to the algorithms with the minimal
trait bounds necessary, as well as a generic interface.</li>
<li><a href="udiff/index.html" title="udiff"><code>udiff</code></a>: Unified diff functionality.</li>
<li><a href="utils/index.html" title="utils"><code>utils</code></a>: utilities for common diff related operations.  This module
provides additional diffing functions for working with text diffs.</li>
</ul>
<h2 id="sequence-diffing" class="section-header"><a href="#sequence-diffing">Sequence Diffing</a></h2>
<p>If you want to diff sequences generally indexable things you can use the
<a href="fn.capture_diff.html" title="capture_diff"><code>capture_diff</code></a> and <a href="fn.capture_diff_slices.html" title="capture_diff_slices"><code>capture_diff_slices</code></a> functions.  They will directly
diff an indexable object or slice and return a vector of <a href="enum.DiffOp.html" title="DiffOp"><code>DiffOp</code></a> objects.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">similar</span>::{<span class="ident">Algorithm</span>, <span class="ident">capture_diff_slices</span>};

<span class="kw">let</span> <span class="ident">a</span> <span class="op">=</span> <span class="macro">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];
<span class="kw">let</span> <span class="ident">b</span> <span class="op">=</span> <span class="macro">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>];
<span class="kw">let</span> <span class="ident">ops</span> <span class="op">=</span> <span class="ident">capture_diff_slices</span>(<span class="ident">Algorithm::Myers</span>, <span class="kw-2">&amp;</span><span class="ident">a</span>, <span class="kw-2">&amp;</span><span class="ident">b</span>);</code></pre></div>
<h2 id="text-diffing" class="section-header"><a href="#text-diffing">Text Diffing</a></h2>
<p>Similar provides helpful utilities for text (and more specifically line) diff
operations.  The main type you want to work with is <a href="struct.TextDiff.html" title="TextDiff"><code>TextDiff</code></a> which
uses the underlying diff algorithms to expose a convenient API to work with
texts:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">similar</span>::{<span class="ident">ChangeTag</span>, <span class="ident">TextDiff</span>};

<span class="kw">let</span> <span class="ident">diff</span> <span class="op">=</span> <span class="ident">TextDiff::from_lines</span>(
    <span class="string">&quot;Hello World\nThis is the second line.\nThis is the third.&quot;</span>,
    <span class="string">&quot;Hallo Welt\nThis is the second line.\nThis is life.\nMoar and more&quot;</span>,
);

<span class="kw">for</span> <span class="ident">change</span> <span class="kw">in</span> <span class="ident">diff</span>.<span class="ident">iter_all_changes</span>() {
    <span class="kw">let</span> <span class="ident">sign</span> <span class="op">=</span> <span class="kw">match</span> <span class="ident">change</span>.<span class="ident">tag</span>() {
        <span class="ident">ChangeTag::Delete</span> =&gt; <span class="string">&quot;-&quot;</span>,
        <span class="ident">ChangeTag::Insert</span> =&gt; <span class="string">&quot;+&quot;</span>,
        <span class="ident">ChangeTag::Equal</span> =&gt; <span class="string">&quot; &quot;</span>,
    };
    <span class="macro">print!</span>(<span class="string">&quot;{}{}&quot;</span>, <span class="ident">sign</span>, <span class="ident">change</span>);
}</code></pre></div>
<h3 id="trailing-newlines" class="section-header"><a href="#trailing-newlines">Trailing Newlines</a></h3>
<p>When working with line diffs (and unified diffs in general) there are two
“philosophies” to look at lines.  One is to diff lines without their newline
character, the other is to diff with the newline character.  Typically the
latter is done because text files do not <em>have</em> to end in a newline character.
As a result there is a difference between <code>foo\n</code> and <code>foo</code> as far as diffs
are concerned.</p>
<p>In similar this is handled on the <a href="struct.Change.html" title="Change"><code>Change</code></a> or [<code>InlineChange</code>] level.  If
a diff was created via <a href="struct.TextDiff.html#method.from_lines" title="TextDiff::from_lines"><code>TextDiff::from_lines</code></a> the text diffing system is
instructed to check if there are missing newlines encountered
(<a href="struct.TextDiff.html#method.newline_terminated" title="TextDiff::newline_terminated"><code>TextDiff::newline_terminated</code></a> returns true).</p>
<p>In any case the <a href="struct.Change.html" title="Change"><code>Change</code></a> object has a convenience method called
<a href="struct.Change.html#method.missing_newline" title="Change::missing_newline"><code>Change::missing_newline</code></a> which returns <code>true</code> if the change is missing
a trailing newline.  Armed with that information the caller knows to handle
this by either rendering a virtual newline at that position or to indicate
it in different ways.  For instance the unified diff code will render the
special <code>\ No newline at end of file</code> marker.</p>
<h3 id="bytes-vs-unicode" class="section-header"><a href="#bytes-vs-unicode">Bytes vs Unicode</a></h3>
<p>Similar module concerns itself with a loser definition of “text” than you would
normally see in Rust.  While by default it can only operate on <a href="https://doc.rust-lang.org/1.59.0/std/primitive.str.html" title="str"><code>str</code></a> types
by enabling the <code>bytes</code> feature it gains support for byte slices with some
caveats.</p>
<p>A lot of text diff functionality assumes that what is being diffed constitutes
text, but in the real world it can often be challenging to ensure that this is
all valid utf-8.  Because of this the crate is built so that most functionality
also still works with bytes for as long as they are roughly ASCII compatible.</p>
<p>This means you will be successful in creating a unified diff from latin1
encoded bytes but if you try to do the same with EBCDIC encoded bytes you
will only get garbage.</p>
<h2 id="ops-vs-changes" class="section-header"><a href="#ops-vs-changes">Ops vs Changes</a></h2>
<p>Because very commonly two compared sequences will largely match this module
splits it’s functionality into two layers:</p>
<p>Changes are encoded as <a href="enum.DiffOp.html">diff operations</a>.  These are
ranges of the differences by index in the source sequence.  Because this
can be cumbersome to work with a separate method <a href="enum.DiffOp.html#method.iter_changes" title="DiffOp::iter_changes"><code>DiffOp::iter_changes</code></a>
(and <a href="struct.TextDiff.html#method.iter_changes" title="TextDiff::iter_changes"><code>TextDiff::iter_changes</code></a> when working with text diffs) is provided
which expands all the changes on an item by item level encoded in an operation.</p>
<p>As the <a href="struct.TextDiff.html#method.grouped_ops" title="TextDiff::grouped_ops"><code>TextDiff::grouped_ops</code></a> method can isolate clusters of changes
this even works for very long files if paired with this method.</p>
<h2 id="deadlines-and-performance" class="section-header"><a href="#deadlines-and-performance">Deadlines and Performance</a></h2>
<p>For large and very distinct inputs the algorithms as implemented can take
a very, very long time to execute.  Too long to make sense in practice.
To work around this issue all diffing algorithms also provide a version
that accepts a deadline which is the point in time as defined by an
<a href="https://doc.rust-lang.org/1.59.0/std/time/struct.Instant.html"><code>Instant</code></a> after which the algorithm should give up.
What giving up means depends on the algorithm.  For instance due to the
recursive, divide and conquer nature of Myer’s diff you will still get a
pretty decent diff in many cases when a deadline is reached.  Whereas on the
other hand the LCS diff is unlikely to give any decent results in such a
situation.</p>
<p>The <a href="struct.TextDiff.html" title="TextDiff"><code>TextDiff</code></a> type also lets you configure a deadline and/or timeout
when performing a text diff.</p>
<h2 id="feature-flags" class="section-header"><a href="#feature-flags">Feature Flags</a></h2>
<p>The crate by default does not have any dependencies however for some use
cases it’s useful to pull in extra functionality.  Likewise you can turn
off some functionality.</p>
<ul>
<li><code>text</code>: this feature is enabled by default and enables the text based
diffing types such as <a href="struct.TextDiff.html" title="TextDiff"><code>TextDiff</code></a>.
If the crate is used without default features it’s removed.</li>
<li><code>unicode</code>: when this feature is enabled the text diffing functionality
gains the ability to diff on a grapheme instead of character level.  This
is particularly useful when working with text containing emojis.  This
pulls in some relatively complex dependencies for working with the unicode
database.</li>
<li><code>bytes</code>: this feature adds support for working with byte slices in text
APIs in addition to unicode strings.  This pulls in the
[<code>bstr</code>] dependency.</li>
<li><code>inline</code>: this feature gives access to additional functionality of the
text diffing to provide inline information about which values changed
in a line diff.  This currently also enables the <code>unicode</code> feature.</li>
<li><code>serde</code>: this feature enables serialization to some types in this
crate.  For enums without payload deserialization is then also supported.</li>
</ul>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="algorithms/index.html" title="similar::algorithms mod">algorithms</a></div><div class="item-right docblock-short"><p>Various diff (longest common subsequence) algorithms.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="iter/index.html" title="similar::iter mod">iter</a></div><div class="item-right docblock-short"><p>The various iterators this crate provides.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="udiff/index.html" title="similar::udiff mod">udiff</a></div><div class="item-right docblock-short"><p>This module provides unified diff functionality.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="utils/index.html" title="similar::utils mod">utils</a></div><div class="item-right docblock-short"><p>Utilities for common diff related operations.</p>
</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Change.html" title="similar::Change struct">Change</a></div><div class="item-right docblock-short"><p>Represents the expanded <a href="enum.DiffOp.html" title="DiffOp"><code>DiffOp</code></a> change.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TextDiff.html" title="similar::TextDiff struct">TextDiff</a></div><div class="item-right docblock-short"><p>Captures diff op codes for textual diffs.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TextDiffConfig.html" title="similar::TextDiffConfig struct">TextDiffConfig</a></div><div class="item-right docblock-short"><p>A builder type config for more complex uses of <a href="struct.TextDiff.html" title="TextDiff"><code>TextDiff</code></a>.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Algorithm.html" title="similar::Algorithm enum">Algorithm</a></div><div class="item-right docblock-short"><p>An enum representing a diffing algorithm.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ChangeTag.html" title="similar::ChangeTag enum">ChangeTag</a></div><div class="item-right docblock-short"><p>The tag of a change.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.DiffOp.html" title="similar::DiffOp enum">DiffOp</a></div><div class="item-right docblock-short"><p>Utility enum to capture a diff operation.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.DiffTag.html" title="similar::DiffTag enum">DiffTag</a></div><div class="item-right docblock-short"><p>The tag of a diff operation.</p>
</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.DiffableStr.html" title="similar::DiffableStr trait">DiffableStr</a></div><div class="item-right docblock-short"><p>All supported diffable strings.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.DiffableStrRef.html" title="similar::DiffableStrRef trait">DiffableStrRef</a></div><div class="item-right docblock-short"><p>Reference to a <a href="trait.DiffableStr.html" title="DiffableStr"><code>DiffableStr</code></a>.</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.capture_diff.html" title="similar::capture_diff fn">capture_diff</a></div><div class="item-right docblock-short"><p>Creates a diff between old and new with the given algorithm capturing the ops.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.capture_diff_deadline.html" title="similar::capture_diff_deadline fn">capture_diff_deadline</a></div><div class="item-right docblock-short"><p>Creates a diff between old and new with the given algorithm capturing the ops.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.capture_diff_slices.html" title="similar::capture_diff_slices fn">capture_diff_slices</a></div><div class="item-right docblock-short"><p>Creates a diff between old and new with the given algorithm capturing the ops.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.capture_diff_slices_deadline.html" title="similar::capture_diff_slices_deadline fn">capture_diff_slices_deadline</a></div><div class="item-right docblock-short"><p>Creates a diff between old and new with the given algorithm capturing the ops.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.get_close_matches.html" title="similar::get_close_matches fn">get_close_matches</a></div><div class="item-right docblock-short"><p>Use the text differ to find <code>n</code> close matches.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.get_diff_ratio.html" title="similar::get_diff_ratio fn">get_diff_ratio</a></div><div class="item-right docblock-short"><p>Return a measure of similarity in the range <code>0..=1</code>.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.group_diff_ops.html" title="similar::group_diff_ops fn">group_diff_ops</a></div><div class="item-right docblock-short"><p>Isolate change clusters by eliminating ranges with no changes.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="similar" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.59.0 (9d1b2106e 2022-02-23)" ></div>
</body></html>